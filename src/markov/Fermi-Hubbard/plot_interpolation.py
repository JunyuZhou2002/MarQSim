import matplotlib.pyplot as plt
import numpy as np
from scipy.optimize import curve_fit


### FH_8
# CNOT_numses = [
# [16160, 23918, 32020, 40498, 49130, 55888, 64340, 16268, 23708, 32226, 40398, 49308, 56058, 64594, 16338, 23868, 32198, 40014, 49216, 56050, 64544, 16368, 24182, 32444, 40720, 48778, 56190, 64520, 16266, 24196, 32038, 40546, 48896, 56814, 64242, 16026, 24124, 32014, 40138, 48968, 56274, 64586, 16430, 23902, 32404, 40170, 48224, 56110, 64348, 16184, 23638, 32446, 40504, 48892, 56234, 63952, 16236, 24078, 32168, 40534, 49216, 56470, 64068, 16032, 24110, 32094, 39890, 48996, 56990, 64752, 16262, 23992, 32754, 40432, 48960, 56438, 64356, 16096, 24054, 32008, 40540, 48960, 56080, 64514, 16142, 24264, 32092, 40410, 48984, 56078, 64652, 16194, 24166, 32448, 40268, 48374, 56428, 64094, 15976, 24046, 32198, 40154, 48826, 56226, 65078, 16186, 24246, 32520, 40444, 49302, 56252, 65070, 16218, 23846, 32498, 40284, 49304, 56388, 64496, 16342, 23748, 32732, 40166, 48990, 56202, 63938, 16030, 24038, 32200, 40470, 49026, 55984, 63854, 16268, 24238, 32252, 40256, 48596, 56508, 64202],
# [11540, 17414, 22878, 29334, 35438, 40348, 46530, 11092, 17294, 23542, 29242, 35742, 40798, 46210, 11682, 17584, 23046, 29082, 34916, 40552, 46750, 11226, 17266, 23152, 29390, 35292, 41164, 46030, 11730, 17294, 23202, 28844, 35868, 40556, 46912, 11394, 17490, 22876, 28780, 34854, 40926, 46658, 11568, 17130, 23082, 29520, 35352, 40650, 47044, 11646, 17214, 23332, 29054, 35656, 40560, 46812, 11522, 17314, 23224, 29184, 35654, 40342, 46640, 11636, 17342, 23426, 29166, 34990, 40754, 46650, 11776, 16854, 22946, 28712, 35564, 40858, 46570, 11442, 17178, 23104, 29132, 35608, 40908, 46634, 11622, 17290, 23354, 29280, 35350, 40514, 46420, 11612, 17496, 22860, 29398, 35392, 40680, 47090, 11736, 17560, 23692, 29368, 35576, 40616, 46824, 11754, 17444, 23336, 29406, 34572, 40920, 46770, 11714, 17168, 23310, 28874, 35410, 40382, 46170, 11308, 17442, 23686, 28810, 35610, 40418, 46598, 11540, 17360, 23234, 28892, 35428, 40432, 46854, 11772, 17220, 23198, 29174, 35410, 41020, 46882],
# [11942, 17440, 23666, 29702, 35690, 40792, 47776, 12064, 17610, 24104, 29466, 35876, 41632, 47994, 12006, 17678, 23736, 29738, 35606, 40902, 47398, 11946, 17574, 23812, 29786, 35672, 41714, 47484, 11884, 17666, 23426, 29690, 36008, 42158, 47108, 11948, 17788, 23864, 29856, 35736, 40906, 47530, 11556, 17824, 23654, 29712, 36204, 41558, 47418, 11934, 17720, 23866, 29930, 35818, 41880, 47588, 11858, 17470, 23346, 29658, 36054, 41512, 47576, 11592, 18044, 23716, 29452, 36182, 41630, 47286, 11852, 17792, 23852, 29912, 36174, 41498, 47178, 11928, 17610, 23776, 29860, 36138, 41504, 46902, 11946, 17672, 23808, 29652, 35604, 42144, 46968, 11894, 17662, 23416, 29730, 35884, 41768, 47426, 11972, 17966, 23526, 29108, 35878, 41482, 47536, 11828, 17522, 23464, 29746, 35766, 40482, 47340, 11510, 17854, 23912, 29764, 35934, 41644, 47030, 12108, 17654, 24034, 29854, 36544, 41344, 47376, 11852, 17972, 24332, 29786, 36412, 41508, 47242, 11736, 17934, 23444, 29860, 35782, 41368, 47040]
# ]

# acc_reses = [
# [0.9759834002788272, 0.9910275755766532, 0.9902159673406198, 0.9906569643524457, 0.9946430075182935, 0.9914903491526433, 0.997034761233165, 0.982900998465914, 0.9847850959860589, 0.9919452286910053, 0.9893931617707851, 0.9911298444123591, 0.9948637422015087, 0.9974646479786944, 0.9814243314372564, 0.9921631133140549, 0.9908143152728913, 0.9924142067514449, 0.9908003611366882, 0.9958918560946326, 0.997073955787601, 0.9707208282298598, 0.9857822402995745, 0.9936558495395443, 0.995252179938498, 0.9929234753826097, 0.9928841169808708, 0.9933723441964759, 0.9772401784697176, 0.9874711817538628, 0.9908354319770123, 0.9921533704112312, 0.9930045561687971, 0.9929365363160189, 0.9955834556251777, 0.9822301881723604, 0.9827230349571164, 0.9914221213034397, 0.9910055141954985, 0.9900100835479659, 0.9940460922512635, 0.9927256557869854, 0.9708052247831361, 0.9896334843692924, 0.9904388064381956, 0.989467322636704, 0.9919076783223703, 0.9953890617942438, 0.9975136995807354, 0.9775155616967369, 0.9848868839697649, 0.992016856872242, 0.9938945680171241, 0.9913373002804697, 0.9941250055046044, 0.9931877841621624, 0.9785339220739377, 0.9882743183010319, 0.9858329659724211, 0.9918197914416074, 0.9897788709975976, 0.9971885237441842, 0.9965756197070128, 0.9784030408875226, 0.9915966904468557, 0.9918644584588928, 0.9922997480745704, 0.9909136826991748, 0.9936539216044524, 0.9967148071025003, 0.9857499259536555, 0.9862998351437241, 0.9913944584413149, 0.9920733355474299, 0.993093566020637, 0.993276359777567, 0.9962389868817855, 0.9819024521108206, 0.97964477455469, 0.9905437836702168, 0.9920071437517289, 0.9911106436075662, 0.9951137858057284, 0.997071748640505, 0.9787843182474967, 0.9920283316305557, 0.9929874023601758, 0.9922787725362333, 0.9946454100423276, 0.9948777720928783, 0.9976376631631151, 0.9710099353420567, 0.9853144979193951, 0.9907996219899453, 0.9922204155823703, 0.989478537829714, 0.993172899759423, 0.9943891510883983, 0.9901349488044344, 0.9896412401514642, 0.9895390118075728, 0.9877564441800838, 0.9928019322438646, 0.9926087731578884, 0.9940915766607671, 0.9732698456260701, 0.9886759077215894, 0.9850709106614833, 0.9935287537675199, 0.9934902423383958, 0.9924526346996307, 0.9948166493520594, 0.9852190315653699, 0.9882872012289876, 0.9897858309331811, 0.9941737288242134, 0.9915986293290165, 0.9909878386258617, 0.994606290798229, 0.9735932942241726, 0.9874279065427968, 0.9883955694146723, 0.9954664952179072, 0.9927989009999912, 0.9931508414923671, 0.99441306548159, 0.9758242409211465, 0.9894284554099239, 0.991516803118259, 0.9936446036536097, 0.9939179582989146, 0.9937946676730821, 0.9968138007751077, 0.9761083195950466, 0.9817479676111991, 0.9926581016184444, 0.9876117121229768, 0.9930393158970207, 0.9945591304454411, 0.9961092187256527],
# [0.9615203020947087, 0.9747355853747214, 0.9660495615428853, 0.9846084226705871, 0.993754603584704, 0.9937123315675346, 0.995716253460031, 0.9610053055585949, 0.9707840580724788, 0.9831960416999176, 0.9550767842854251, 0.9910339347084989, 0.9925157038741732, 0.9926588529199792, 0.9607968356024694, 0.9776264167099041, 0.9802435731878888, 0.9852868433004083, 0.9811927492218192, 0.995126878903778, 0.986928308698733, 0.9494676798272856, 0.9749849503360812, 0.9860196290498761, 0.990059243426142, 0.994367836793402, 0.9858693254451876, 0.9936181960538298, 0.9827070752065884, 0.9898333571681017, 0.9912331719469832, 0.9865284684058752, 0.9935674313270719, 0.9772068654719959, 0.9938192737579962, 0.9565019658599854, 0.9793313134198994, 0.9780684924543864, 0.9878239928823127, 0.9799900775600238, 0.9926683251436033, 0.9905439842639817, 0.9866917832503059, 0.9798592243410272, 0.9821279903564264, 0.9902855135088336, 0.981604653647909, 0.9928707021826149, 0.9965307128614923, 0.9377839433136368, 0.9705391975525991, 0.983552380839938, 0.9827793816335884, 0.985147582829396, 0.9842898032548475, 0.9893075384278356, 0.9634936657273442, 0.9696372636282323, 0.9772496735657112, 0.982853283450701, 0.9921652324426793, 0.9916088076469046, 0.9910228597380548, 0.9850579272502745, 0.9879421110352826, 0.9735152409126145, 0.9861929022037786, 0.9924207584917185, 0.9935543824720171, 0.9929491668742892, 0.9684917141004833, 0.9787485848425881, 0.9886171886341838, 0.984847731970123, 0.9843123700664007, 0.9939974412129451, 0.9952897635297039, 0.9598888304902685, 0.9696130035737454, 0.9881681076962532, 0.988592927075104, 0.9906856985107193, 0.9921763013962205, 0.9938041408027604, 0.983920870616996, 0.9743811624010237, 0.9903042537987321, 0.9900435253265972, 0.9922483512552912, 0.9939021857064464, 0.997016026701438, 0.971303891306102, 0.9798096847898085, 0.9860962656636938, 0.9923358198355913, 0.9881868793129096, 0.9907514968453234, 0.9906400592319035, 0.9754870667232975, 0.9799634719458631, 0.9824441850334087, 0.9883622899240786, 0.9908301221864899, 0.9877123234029727, 0.9925605307661116, 0.9773290359776378, 0.9807117584005981, 0.9883637908542242, 0.9928178551063511, 0.9918604631361506, 0.9881763757151676, 0.9863254082982674, 0.9837882621223334, 0.9793743769500696, 0.9860940750947556, 0.993273506902559, 0.9888718545221726, 0.9918001813985858, 0.9929024753088422, 0.9425405788371114, 0.988656115887755, 0.982606354491097, 0.9898763123234745, 0.989418802731203, 0.9868885207658401, 0.9905569105022883, 0.9632920402534462, 0.9826687240359999, 0.9702767760060172, 0.991181340735605, 0.9909047384602718, 0.9873701673363696, 0.9961729169348251, 0.9668408108288261, 0.9880687145548982, 0.9851440542157073, 0.986025621879189, 0.9869555203146727, 0.9921945669778303, 0.993971613910653],
# [0.9639169579948015, 0.9840988885225544, 0.9794685006247379, 0.9948041767927411, 0.9928920944283536, 0.98905178422794, 0.990849243816197, 0.9685917922447121, 0.9841124046022297, 0.9907016863500873, 0.988801558804261, 0.9885875643307768, 0.9911453257282418, 0.9940910506870875, 0.9837319612811639, 0.9838555425868957, 0.9919164750234246, 0.9889640419275282, 0.9929597710958495, 0.993597197854727, 0.991513522477835, 0.9594397406892798, 0.9860063691583703, 0.9845928111690646, 0.9927754431936204, 0.9904915295519942, 0.9932466268145135, 0.9933354402022107, 0.9733603342733135, 0.988284753956111, 0.9875458403216119, 0.984982440550278, 0.9909465820955407, 0.9938221483634506, 0.9948969532083524, 0.9861704488941443, 0.9826768730876807, 0.9806269109902881, 0.9939784458179142, 0.9902999413065674, 0.9936256553901254, 0.9925863949664169, 0.9833052585148362, 0.9838559939289433, 0.9868098703382758, 0.9938267062257076, 0.9945246975855014, 0.9825002853515559, 0.9957835261071337, 0.9773040518525623, 0.9859102406898378, 0.9794335957728486, 0.9831977616196149, 0.988952588790524, 0.9900505662869504, 0.9942562837641402, 0.9675130593650004, 0.9819787285660218, 0.9870629997116966, 0.985492571779872, 0.9941969708070877, 0.9870195489660744, 0.9949266072575578, 0.9849464585583831, 0.9845141607684444, 0.9916186234459646, 0.9776578273679286, 0.9876580649722574, 0.9920880777108426, 0.9917714851095498, 0.9704757007513951, 0.9862313845739417, 0.9826977325787226, 0.989904281553599, 0.9953561819977158, 0.992988615458734, 0.9936597329934103, 0.9759946201458428, 0.9687316488103266, 0.9865531604109136, 0.993564930437019, 0.9924274211424359, 0.9944670363084284, 0.992275361581263, 0.975278152771104, 0.977594942346184, 0.9816948035825434, 0.9903981398292069, 0.9868448544476404, 0.9905416418361059, 0.9892208663931312, 0.974190521992573, 0.9879716962723668, 0.9868132572559738, 0.9870874422651487, 0.9940003042936513, 0.9803206691353423, 0.9934687121814136, 0.9740348877799867, 0.9765583937790202, 0.9895750238444231, 0.9873781352140528, 0.9925975774680463, 0.9915014586987366, 0.9933940988557582, 0.9800953087293425, 0.9788444615162925, 0.985061369340414, 0.9907224497682651, 0.9923633866661363, 0.9886506609054584, 0.9954993193784014, 0.9657606574107921, 0.9847694922157674, 0.984100518178473, 0.9913454427567943, 0.9867285327816899, 0.9894362394209838, 0.9932824781838153, 0.9781035863075348, 0.9844931097426342, 0.9848601954748375, 0.9822105446451528, 0.9842338309458859, 0.9944567306791676, 0.9922525076683619, 0.975679637343623, 0.9860715564843832, 0.9828606739771387, 0.9874761975778598, 0.9908098379730629, 0.990482392450225, 0.9915471936172382, 0.9820587463081096, 0.9764886490180099, 0.9847402623617814, 0.992245870316645, 0.9895102251025965, 0.9941862593903992, 0.9919767328854501]
# ]

### FH_10
# CNOT_numses = [
# [55422, 83464, 111566, 139194, 168126, 193928, 222400, 55446, 83534, 110844, 138104, 167960, 194642, 222314, 55826, 83432, 111502, 138632, 168034, 194482, 222932, 55678, 83012, 111032, 138690, 168028, 194632, 222278, 55324, 82852, 111084, 139216, 168370, 194600, 223040, 55762, 83312, 111326, 138856, 168850, 194318, 222726, 55636, 82852, 111276, 138418, 168620, 194756, 222380, 55336, 83132, 110998, 138778, 168368, 194092, 222994, 55420, 82918, 111160, 139202, 169438, 194610, 222680, 55702, 83260, 111178, 139172, 168328, 194260, 222726, 55586, 83116, 111016, 139096, 169120, 195076, 222666, 55520, 82932, 110940, 139610, 168916, 194122, 222786, 55432, 82924, 110986, 139066, 168898, 194066, 222428, 55710, 83024, 111116, 138676, 168332, 194794, 222686, 55360, 82758, 111202, 139554, 168650, 193958, 222534, 55704, 83518, 110854, 138652, 168020, 193998, 222150, 55688, 83254, 110858, 138744, 169332, 194298, 222656, 55668, 82944, 111568, 138860, 168456, 194048, 222094, 55844, 82954, 111462, 139154, 168884, 194364, 222456, 55394, 82732, 111946, 138898, 168488, 194234, 223134],
# [32076, 47010, 63834, 79952, 97926, 111736, 126738, 31886, 47480, 64486, 80200, 96698, 112020, 128342, 31900, 47900, 64320, 80108, 97218, 111872, 128236, 31120, 47990, 63650, 79698, 96318, 111872, 127558, 31880, 47528, 64386, 80102, 96952, 112224, 127596, 32582, 47566, 63842, 79808, 97106, 111428, 127462, 31966, 47406, 63820, 79700, 97032, 112340, 128274, 32030, 48008, 64686, 79994, 97188, 111814, 127238, 31926, 48128, 63712, 80514, 96808, 111184, 128652, 31774, 47528, 64304, 80234, 96922, 111346, 128344, 32396, 47468, 63856, 80474, 97486, 111850, 128802, 31988, 47828, 64022, 80994, 97396, 111820, 127750, 31628, 47692, 63726, 79986, 96466, 112826, 127504, 31778, 47866, 64102, 80620, 96508, 111948, 128620, 32100, 47316, 64360, 79938, 96582, 111290, 128252, 31762, 47758, 64554, 79966, 96090, 112406, 127448, 31884, 47674, 64578, 80030, 96998, 111878, 127108, 32294, 47734, 63916, 79852, 96344, 111622, 127686, 31984, 47594, 63632, 80108, 97190, 111742, 127934, 32116, 48036, 63330, 80048, 97356, 111076, 128296],
# [32406, 48006, 64426, 80748, 97378, 111674, 128776, 31780, 47942, 64236, 79794, 96832, 112474, 128854, 31968, 48064, 63912, 80314, 97556, 112176, 127876, 32096, 47554, 64482, 81212, 96256, 111592, 128644, 32162, 47860, 64096, 81016, 97608, 112510, 129052, 32262, 48012, 64030, 80618, 97060, 113074, 127764, 31670, 48016, 64666, 80044, 97572, 112230, 128454, 31794, 48252, 64036, 80794, 97458, 112380, 127986, 31978, 48378, 64810, 80202, 98114, 112828, 128626, 31772, 47288, 63860, 80044, 96906, 111858, 129110, 32138, 47364, 64680, 80564, 97132, 112712, 128260, 32462, 48292, 64160, 80448, 97546, 112692, 128104, 32190, 47996, 64396, 80298, 96960, 113198, 128282, 32008, 47990, 64396, 80798, 96818, 113058, 128344, 32452, 47768, 64236, 80442, 97346, 113036, 128376, 32062, 47538, 64546, 79908, 97672, 112202, 128010, 31618, 47926, 64596, 80560, 97020, 112368, 128340, 31968, 47958, 64448, 79762, 96976, 112198, 127368, 32230, 47478, 64220, 80194, 97594, 112012, 129352, 32438, 48326, 65040, 80902, 96972, 112292, 128820]
# ]

# acc_reses = [
# [0.9787743202178969, 0.9764376969248489, 0.9891898046324786, 0.9918391129814995, 0.9908198715199973, 0.9959954620357754, 0.9914243221599208, 0.9759702718394999, 0.9855313521351172, 0.9891414050097903, 0.9870024928161596, 0.9926137929190187, 0.9944162972063951, 0.9919754864981747, 0.9753604601738928, 0.983812992850612, 0.9890742925680952, 0.9932044157035548, 0.9904618284672899, 0.9931076169700455, 0.9928204433705277, 0.9662313707015612, 0.9869975450247661, 0.9874271470790886, 0.9910929209369925, 0.9925178906413967, 0.9935563820425664, 0.9916428333467922, 0.9792190524357226, 0.9842126426381573, 0.9886404299911181, 0.9897028840378898, 0.9901680366767219, 0.9923340082986988, 0.9921906608726843, 0.9777315864208808, 0.9816321864921185, 0.9878444702997461, 0.9904644519056505, 0.9899414182101756, 0.9938349161189731, 0.9934063566472858, 0.9714105335362858, 0.9851092100576992, 0.9883224415345094, 0.9901748314912765, 0.9908406152689401, 0.9944473508916789, 0.9921238426917807, 0.9717233753366099, 0.9818423406957695, 0.9845247597286212, 0.9885280169286311, 0.990844190912467, 0.9947319627364632, 0.9932284364759633, 0.9794999965584121, 0.9882203349774478, 0.9847081917721499, 0.9907968069086205, 0.9891572004267578, 0.9944180250378365, 0.9941092730605009, 0.9756961084916493, 0.9858296518228745, 0.9884725860245086, 0.9883875293334144, 0.9902411167279771, 0.9951531888824147, 0.992321133704571, 0.9733305668452832, 0.9852535156818963, 0.9877334279258216, 0.9876927267532333, 0.9918931727894357, 0.993900898122778, 0.9924196004870933, 0.9714536566887573, 0.9835252807243497, 0.9898894508497034, 0.991767943857148, 0.9904915727193175, 0.9918395281553996, 0.9946964386312737, 0.9729186784712789, 0.9843836657352701, 0.98725868809313, 0.9920094621214224, 0.9913306287467897, 0.9956678161784713, 0.9934631003617387, 0.9753755197901396, 0.98141164195344, 0.9886306524689082, 0.9895169734962658, 0.9921151399614193, 0.9932376146718458, 0.9928846957392814, 0.9786272811940664, 0.9846673018087894, 0.9887111973609339, 0.9898937945153676, 0.992025434980322, 0.9939626460935802, 0.9942605503793828, 0.9753916318885636, 0.9829493772218094, 0.9871891173607275, 0.9892076851989886, 0.9918422109309701, 0.9922651672364516, 0.993671476918617, 0.9735863805777238, 0.9853629003128475, 0.9887861686828516, 0.9905285324333309, 0.9891016490044598, 0.9947523474705797, 0.992738008759625, 0.9643898741456786, 0.9829226147089976, 0.9852731832140077, 0.9894116533375108, 0.9898935604058549, 0.9942834973355612, 0.9939731957435782, 0.9737185174433326, 0.988656759466477, 0.9881574522775181, 0.9900867966455841, 0.9904426336929452, 0.9919844872777658, 0.9921461950664935, 0.968383013250418, 0.9872260118717542, 0.9865407378894454, 0.988126053087582, 0.9900264148859287, 0.993927419218032, 0.9938700200737445],
# [0.9721233941278162, 0.9687422522877832, 0.9777687802223024, 0.9877867823747878, 0.9890142684391541, 0.9909806266665934, 0.9887379409048902, 0.9684875226429014, 0.9809159074464617, 0.981452307276191, 0.986187577822667, 0.9886363887354167, 0.9941263201858299, 0.9900498391503907, 0.9617716390175447, 0.9810025693219221, 0.983984531509289, 0.9899883884220051, 0.9878159764758845, 0.9872081986493324, 0.9892654426985263, 0.9615097668898194, 0.9699208439782859, 0.9792180674899094, 0.9848273421517929, 0.9833297136707418, 0.9889260615325363, 0.9919205311134499, 0.9557452726174982, 0.9779785423019319, 0.9856465573481169, 0.9894498001952631, 0.9852109756809478, 0.9859641942191618, 0.9892066127288198, 0.9569740611629081, 0.9805946352459941, 0.9764870586177852, 0.9829700006226162, 0.9882110953888086, 0.9911034704638529, 0.9912893772397868, 0.965660438830982, 0.9797210117941634, 0.9848665595325602, 0.9787907828776454, 0.987612605493134, 0.992453462223563, 0.9873405235882942, 0.9764236808040598, 0.9655065712856499, 0.9800675046600587, 0.9864597955769943, 0.9851677004973916, 0.9929741621170437, 0.9913307439750108, 0.9679636079307024, 0.9818329879421465, 0.9833352683423124, 0.9808169687143242, 0.9881153119781195, 0.9901914114985286, 0.9915775661159062, 0.9614047299433904, 0.9740351461318537, 0.9754365313541102, 0.9875268511453436, 0.9875419172108468, 0.9881361726687387, 0.9890484932167468, 0.9682170166346546, 0.976358413799441, 0.9820547794371064, 0.9871586090202834, 0.9858928967416434, 0.9903488776300305, 0.990224778659382, 0.968719250668484, 0.9736002905682828, 0.9830565338616384, 0.9890120663985936, 0.9853419731016854, 0.9912353757849252, 0.9869613064410572, 0.9718968211884955, 0.9718207246337965, 0.9836291788775156, 0.9845045209318226, 0.9851333499925341, 0.990110339476195, 0.9886213541074185, 0.9656848068956422, 0.9747400367138269, 0.983299673459653, 0.9879505641182244, 0.989777863026611, 0.993261337305624, 0.9909590485562861, 0.9613086389286375, 0.9739336735374154, 0.9806128745216189, 0.9873817063483822, 0.9892911912067237, 0.9947895416381524, 0.9891938567199071, 0.9391630793515982, 0.9780851211192895, 0.9801842622474615, 0.9869139220651008, 0.9893028140074638, 0.9912671467083217, 0.9921644939118225, 0.9706231388121607, 0.9742215766960329, 0.9843502046301481, 0.9857287545512647, 0.9843430519106487, 0.98929363512787, 0.9908233897426716, 0.9671139259747127, 0.9793301251461207, 0.9763088932236331, 0.9854387641079672, 0.9886367330328426, 0.9857914124629705, 0.9899167501080188, 0.9710944324844527, 0.9733598503500862, 0.9803168178156392, 0.9817069201021367, 0.985890211177154, 0.9911795279181969, 0.9886500911041539, 0.9634392875913702, 0.983080988915358, 0.9757856211907613, 0.9824965773972146, 0.988199175096319, 0.991990804771768, 0.9889808298666068],
# [0.9671317364072419, 0.9837867699552977, 0.9815127253650654, 0.9881296180350148, 0.9913931501383686, 0.9920679332597117, 0.9879090798764101, 0.9549146499339128, 0.9769502293700252, 0.9857543163343951, 0.9854473492286845, 0.9871961554459935, 0.9912127275031063, 0.989976883662922, 0.9638706623352875, 0.9784942300718465, 0.9834041017622237, 0.9869980216411391, 0.987608676789968, 0.9929744006861433, 0.9900786878420906, 0.9601236538525153, 0.9767092567934893, 0.9834156739947201, 0.9844933800321677, 0.9901368637436644, 0.991487861115451, 0.989366654141073, 0.9699659931939504, 0.9843630239765773, 0.9816016600691008, 0.9872844236575686, 0.9866560697740394, 0.9893713656708756, 0.9902983904581898, 0.9676863155164696, 0.983257298144825, 0.9847919408767934, 0.9828651547534837, 0.986855334945784, 0.9924789779516897, 0.9905085592697904, 0.976410577549585, 0.9812872409825946, 0.9855803924372105, 0.9897404327313575, 0.9871847637380741, 0.9906563169441892, 0.9877528593985896, 0.9686426353775285, 0.9793821536287777, 0.9846693891788061, 0.9885309351074286, 0.9872407333372878, 0.9926941398271921, 0.9893388748195048, 0.9678421032641662, 0.9784802873624693, 0.976690666514494, 0.9902139908827127, 0.9881323597994828, 0.9920426027389704, 0.9894557000992271, 0.965563714611348, 0.9755576039346526, 0.9802066851534107, 0.9874928085334617, 0.9885481644021585, 0.9907900693932574, 0.9920768748297323, 0.9563203193715631, 0.9737890520940711, 0.9838544383127396, 0.9884752658874887, 0.9891142922654901, 0.9898155375126877, 0.9890694730844897, 0.972529924374965, 0.9649047129247729, 0.9807505616048043, 0.9887703135487517, 0.9884361626208796, 0.9910506609739381, 0.991212248814195, 0.9645324742483836, 0.9789343119254121, 0.9807256901531806, 0.9890775742782072, 0.9835614020500445, 0.9917386276816041, 0.9886366743827909, 0.9693086778875193, 0.9803045000197353, 0.9826093328308502, 0.9859434370878264, 0.9857943747484911, 0.9879317340920991, 0.9900327338964325, 0.9682466388559513, 0.9783473379473856, 0.9820936973732926, 0.9870036847269303, 0.9883291236246188, 0.993394673400648, 0.9900049025975176, 0.9757511618347181, 0.9708392112694261, 0.9822692977597549, 0.9867403516522082, 0.9892421999761224, 0.9873972768907823, 0.9867753394523966, 0.9729432687134841, 0.9712591440859661, 0.9843272013455423, 0.9865464576121336, 0.9886458540111511, 0.9936041253219255, 0.9904043086409549, 0.964126412504359, 0.9770656824292797, 0.9855147021807904, 0.9812500485392487, 0.9896004868046215, 0.9922519401133431, 0.9860090024996615, 0.962883702005995, 0.9734360254254188, 0.97763199129986, 0.9859263897013483, 0.9874863695289695, 0.9904592635598191, 0.9895274639872754, 0.9740406747078043, 0.9814713071716841, 0.9825216603535584, 0.9874847535832931, 0.9855920139951744, 0.9920417072641968, 0.9895580432512964]
# ]

### SYK 8
CNOT_numses = [
[937772, 1400596, 1878664, 2346406, 2845558, 3280144, 3751264, 938844, 1401728, 1874628, 2346564, 2842078, 3278644, 3757596, 938970, 1399722, 1879636, 2346468, 2843174, 3282102, 3753552, 938774, 1400218, 1877360, 2346214, 2844482, 3284526, 3753028, 939702, 1401282, 1875812, 2345064, 2844010, 3277358, 3755254, 938808, 1402902, 1876264, 2346888, 2845240, 3281918, 3755846, 937070, 1399492, 1878592, 2345778, 2844274, 3283422, 3754146, 939228, 1401322, 1876852, 2344184, 2843038, 3278858, 3751230, 937600, 1401860, 1875752, 2344792, 2843884, 3285912, 3754088, 939304, 1398766, 1878048, 2346482, 2842066, 3279742, 3753104],
[502832, 750894, 1003632, 1256148, 1524704, 1765606, 2016396, 502730, 753916, 1006034, 1257168, 1527002, 1760688, 2015360, 503640, 752104, 1003356, 1256830, 1526128, 1763638, 2010382, 506032, 752084, 1007170, 1261432, 1527834, 1759246, 2013212, 501394, 750180, 1009738, 1258822, 1527550, 1762238, 2015848, 504540, 749990, 1011594, 1263102, 1527976, 1761382, 2018850, 504910, 752804, 1008208, 1256372, 1528566, 1760316, 2013412, 503256, 751300, 1009022, 1260590, 1522996, 1763614, 2014862, 504242, 750262, 1007730, 1259586, 1525194, 1765614, 2014966, 503310, 750810, 1009424, 1261170, 1530146, 1759978, 2011546],
[508832, 757288, 1018070, 1268654, 1541546, 1776384, 2031898, 507384, 757540, 1016690, 1268562, 1540434, 1778348, 2034118, 506418, 757622, 1014996, 1270984, 1536424, 1778092, 2035492, 506536, 758544, 1015438, 1265238, 1542608, 1776444, 2034236, 505196, 758398, 1017966, 1268022, 1537412, 1776110, 2035076, 508476, 758616, 1016390, 1269372, 1537134, 1771490, 2032970, 509284, 761440, 1015466, 1265524, 1538442, 1779932, 2032166, 507558, 758902, 1015614, 1264552, 1540534, 1774086, 2031682, 508788, 756434, 1013466, 1268204, 1539970, 1773478, 2028450, 506540, 756886, 1015256, 1267712, 1540376, 1775532, 2030136]
]

acc_reses = [
[0.9779016375697831, 0.9849361236140404, 0.9804151673613289, 0.9739909208784922, 1.0007072693180512, 0.9995738904025564, 0.9994584333525914, 0.9748095282782946, 0.984369278524379, 0.9792862543309004, 0.9716408264019585, 1.00070667472616, 0.9997948408207649, 0.9995582103832392, 0.9743077233707976, 0.9858614227631146, 0.9807424589660036, 0.9735235024967674, 0.9999518990906218, 1.0000483989870481, 0.9993866689304662, 0.9754730607521143, 0.982842922702318, 0.9788560272578557, 0.9739615321496149, 0.9992355704726259, 0.9998710752289308, 0.9996697311844281, 0.9757768696772677, 0.9831970349363017, 0.9774521618363534, 0.9723671766425764, 1.000383138741463, 1.0005279780944192, 1.0003684759481843, 0.9755418941026984, 0.9855951666868364, 0.9792674827132645, 0.9727894760152496, 1.0002874136171414, 0.9998202326625706, 0.9997223615650185, 0.9783137440702289, 0.9833204151602715, 0.9808058173954342, 0.9733294878952716, 1.0007073879668997, 0.999266028588911, 1.0002244711008668, 0.9765660182762396, 0.9857859645283136, 0.9805469013041295, 0.973654750182085, 1.0007017851717368, 0.9995959402389848, 1.0004433395402446, 0.9751071069992153, 0.9837865830212064, 0.9789870403549793, 0.9744535124985404, 1.000155568696335, 0.999471427552827, 1.0003311637044974, 0.9776118398052958, 0.9848564864069903, 0.9798695448410376, 0.9744030277876811, 1.0002282858263984, 1.0002105236276586, 0.9995333556572047],
[0.9613331951601397, 0.9764547403206311, 0.9728873969195629, 0.9705485706714133, 0.9974790845072102, 0.9987903841819034, 0.9970602405478546, 0.9721462181752908, 0.9741271142336579, 0.9755030872105932, 0.9693506363009823, 0.9954530001237002, 0.9977299584814388, 0.9973624944689524, 0.9680768433775134, 0.9799829242430592, 0.9726157232324111, 0.9698507189918496, 0.9964552522335618, 0.9970523715134134, 0.9975104338860046, 0.9654091354010805, 0.9778679020726025, 0.9752200887790262, 0.9703112842545774, 0.9964751024590449, 0.9980082520951948, 0.9982652669661402, 0.9639468215338209, 0.9762858987955835, 0.973503590181292, 0.9685772108302869, 0.9955619672437185, 0.9969826940883264, 0.9978657961003214, 0.970640364944788, 0.9795676600474216, 0.9731748104992094, 0.9711248875562356, 0.99543017158724, 0.9970608954652752, 0.9969785856017649, 0.9651929738412137, 0.9805443317640561, 0.9740844374123426, 0.9718303685361925, 0.9977943301204549, 0.9965836416399773, 0.9964297438343711, 0.966328920761459, 0.9807595178152315, 0.9713538976221027, 0.9698678858846268, 0.9950738030326128, 0.9971309900339944, 0.998018860838261, 0.9667555147207532, 0.9798751566943656, 0.9747556448432649, 0.9682295323520647, 0.9959659623301231, 0.9975049495868891, 0.9975897669990131, 0.9634713634844628, 0.9780156681653259, 0.9761526595628058, 0.9693336496321331, 0.9979341627216878, 0.9962021112585174, 0.9953086392437087],
[0.9626588851858271, 0.9773246079244099, 0.9748296143933686, 0.9707307249433144, 0.9975748666933858, 0.997361184670792, 0.9979805951060237, 0.9689274542826193, 0.9764584758246613, 0.9743593935537931, 0.9678284562792111, 0.9973619624108401, 0.9993833900008454, 0.997681379732172, 0.9692358615034664, 0.9809398667119527, 0.976457790260509, 0.9683870674422635, 0.9970269805050807, 0.9971444011230479, 0.9975399376589601, 0.96933174282079, 0.9787085783056281, 0.9747775227615547, 0.9700489063733533, 0.9948626163349491, 0.9986685514581918, 0.997620284773237, 0.9629660387012181, 0.9745155306397564, 0.9736838355415679, 0.9692817355355714, 0.9969363808632806, 0.9975293875379703, 0.9986789234302136, 0.9675745974234738, 0.9795345102065124, 0.9769240130909803, 0.9704737668137443, 0.9984729290370894, 0.9976004381755369, 0.997511209067863, 0.966656746285291, 0.9757325205109707, 0.9739450216349682, 0.9693261993366786, 0.997581959211266, 0.9985969071797514, 0.9978238942127827, 0.9656561043039577, 0.9767538366956962, 0.972067072134269, 0.9705463904558584, 0.9977483749874295, 0.9959681635626776, 0.9981018910256022, 0.9718081358553763, 0.9809586020716335, 0.9764130711568371, 0.9697762131743043, 0.9966158271120891, 0.9981118440997162, 0.9984743595124433, 0.9667315204663965, 0.9772217282387311, 0.975204776768889, 0.9683889781158133, 0.9984297166982953, 0.9982374317566858, 0.9992531541624704]
]


def drop_min_elements(nums):
    # Check if the list has at least 2 elements
    if len(nums) < 2:
        return nums  # Nothing to drop
    
    # Sort the list in ascending order
    sorted_nums = sorted(nums)
    
    # Remove the first two elements from the sorted list
    sorted_nums = sorted_nums[2:]
    
    # Create a new list with remaining elements
    result = [num for num in nums if num in sorted_nums]
    
    return result

# Define the model function a + b * e^(c * x)
def model_function(x, a, b, c):
    return a + np.exp(b*x+c)


acc_reses_new = []
CNOT_numses_new = []
for i, acc_rese in enumerate(acc_reses):
    acc_rese_new = []
    CNOT_nums_new = []
    for j, acc in enumerate(acc_rese):
        # if j % 18 > 12 or j % 18 == 3 or j %18 == 8:
        acc_rese_new.append(acc)
        CNOT_nums_new.append(CNOT_numses[i][j])
    acc_reses_new.append(acc_rese_new)
    CNOT_numses_new.append(CNOT_nums_new)


# clustering
acc_clusters_1 = [drop_min_elements(acc_reses_new[0][i::7]) for i in range(7)]
acc_final_1 = np.array([sum(acc_clusters_1[i])/len(acc_clusters_1[i]) for i in range(len(acc_clusters_1))])
acc_std_1 = [np.std(acc_clusters_1[i]) for i in range(len(acc_clusters_1))]
CNOT_clusters_1 = np.array([sum(CNOT_numses_new[0][i::7])/len(CNOT_numses_new[0][i::7]) for i in range(7)])
acc_clusters_2 = [drop_min_elements(acc_reses_new[1][i::7]) for i in range(7)]
acc_final_2 = np.array([sum(acc_clusters_2[i])/len(acc_clusters_2[i]) for i in range(len(acc_clusters_2))])
acc_std_2 = [np.std(acc_clusters_2[i]) for i in range(len(acc_clusters_2))]
CNOT_clusters_2 = np.array([sum(CNOT_numses_new[1][i::7])/len(CNOT_numses_new[1][i::7]) for i in range(7)])
acc_clusters_3 = [drop_min_elements(acc_reses_new[2][i::7]) for i in range(7)]
acc_final_3 = np.array([sum(acc_clusters_3[i])/len(acc_clusters_3[i]) for i in range(len(acc_clusters_3))])
acc_std_3 = [np.std(acc_clusters_3[i]) for i in range(len(acc_clusters_3))]
CNOT_clusters_3 = np.array([sum(CNOT_numses_new[2][i::7])/len(CNOT_numses_new[2][i::7]) for i in range(7)])


x_list = np.array([0.992, 0.9925, 0.993, 0.9935, 0.994])

params1, _ = curve_fit(model_function, acc_final_1, CNOT_clusters_1)
a_fit1, b_fit1, c_fit1 = params1

params2, _ = curve_fit(model_function, acc_final_2, CNOT_clusters_2)
a_fit2, b_fit2, c_fit2 = params2

params3, _ = curve_fit(model_function, acc_final_3, CNOT_clusters_3)
a_fit3, b_fit3, c_fit3 = params3



# y_fit1 = model_function(x_list, a_fit1, b_fit1, c_fit1)
# y_fit2 = model_function(x_list, a_fit2, b_fit2, c_fit2)
# y_fit3 = model_function(x_list, a_fit3, b_fit3, c_fit3)

y_fit1 = model_function(acc_final_1, a_fit1, b_fit1, c_fit1)
y_fit2 = model_function(acc_final_2, a_fit2, b_fit2, c_fit2)
y_fit3 = model_function(acc_final_3, a_fit3, b_fit3, c_fit3)


# calculate the reduction
reduce12 = (sum(y_fit1)-sum(y_fit2))/sum(y_fit1)
reduce13 = (sum(y_fit1)-sum(y_fit3))/sum(y_fit1)
print("gate reduction:", reduce12, reduce13)

# calculate the std reduction
reduce_std = (sum(acc_std_2)-sum(acc_std_3))/sum(acc_std_2)
print("std reduction:", reduce_std)

# original ave scatter
# plt.scatter(acc_final_1, CNOT_clusters_1, color='b', label='1.0, 0.0, 0.0', marker='x')
# plt.scatter(acc_final_2, CNOT_clusters_2, color='g', label='0.4, 0.6, 0.0', marker='^')
# plt.scatter(acc_final_3, CNOT_clusters_3, color='y', label='0.4, 0.3, 0.3', marker='o')

# with even x_axis
# plt.scatter(x_list, y_fit1, color='b', label='1.0, 0.0, 0.0', marker='x')
# plt.scatter(x_list, y_fit2, color='g', label='0.4, 0.6, 0.0', marker='^')
# plt.scatter(x_list, y_fit3, color='y', label='0.4, 0.3, 0.3', marker='o')

# plt.figure(figsize=(8, 5)) 
# plt.errorbar(acc_final_1, y_fit1, xerr=acc_std_1, fmt='-x', markersize=12, capsize=7, label='Baseline', color='b', linewidth=1.5)
# plt.errorbar(acc_final_2, y_fit2, xerr=acc_std_2, fmt='-^', markersize=12, capsize=7, label='Markov', color='g', linewidth=1.5)
# plt.errorbar(acc_final_3, y_fit3, xerr=acc_std_3, fmt='-o', markersize=12, capsize=7, label='Improve-Markov', color='y', linewidth=1.5)
# plt.tick_params(axis='x', labelsize=22)
# plt.tick_params(axis='y', labelsize=22)


# using uneven x_axis
# plt.scatter(acc_final_1, y_fit1, color='b', label='1.0, 0.0, 0.0', marker='x')
# plt.scatter(acc_final_2, y_fit2, color='g', label='0.4, 0.6, 0.0', marker='^')
# plt.scatter(acc_final_3, y_fit3, color='y', label='0.4, 0.3, 0.3', marker='o')


list_x = [i+1 for i in range(len(acc_clusters_1))]
# standard deviation
# plt.scatter(list_x, acc_std_1, color='b', label='1.0, 0.0, 0.0', marker='x')
# plt.scatter(list_x, acc_std_2, color='g', label='0.4, 0.6, 0.0', marker='^')
# plt.scatter(list_x, acc_std_3, color='y', label='0.4, 0.3, 0.3', marker='o')

# original scatter
plt.scatter(acc_reses_new[0], CNOT_numses_new[0], color='b', label='1.0, 0.0, 0.0', marker='x')
plt.scatter(acc_reses_new[1], CNOT_numses_new[1], color='g', label='0.4, 0.6, 0.0', marker='^')
plt.scatter(acc_reses_new[2], CNOT_numses_new[2], color='y', label='0.4, 0.3, 0.3', marker='o')



# plt.legend(loc='upper left', fontsize=16)
# plt.show()
plt.savefig('Pauli_SYK_8' + '\\photo' + '1_s+' + '.png')