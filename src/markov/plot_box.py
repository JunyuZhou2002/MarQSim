import matplotlib.pyplot as plt

# using this function to process the row data of CNOT_numses and acc_reses
def data_process(CNOT_numses, acc_reses, step, alpha):
    num = len(CNOT_numses)
    group_CNOT_numses = []
    group_acc_reses = []

    for i in range(num):
        CNOT = CNOT_numses[i]
        acc = acc_reses[i]

        maximum = max(CNOT)
        minimum = min(CNOT)
        k_max = int((maximum + step - 0.00001) // step)
        k_min = int(minimum // step)
        rounded_max = k_max * step
        rounded_min = k_min * step

        group_CNOT = [k*step+step/2 for k in range(k_min, k_max)]
        group_acc_0 = [[] for k in range(k_min, k_max)]

        num_ = len(CNOT)
        for j in range(num_):
            k = CNOT[j]
            k = int(k // step -k_min)
            group_acc_0[k].append(acc[j])


        group_acc = [sum(group_acc_0[k-k_min])/len(group_acc_0[k-k_min]) if len(group_acc_0[k-k_min]) != 0 else 0 for k in range(k_min, k_max)]
 
        count = 0
        for j in range(len(group_acc)):
            if group_acc[j-count] == 0:
                group_acc.pop(j-count)
                group_CNOT.pop(j-count)
                count = count+1

        num_remove = int(len(group_acc) * alpha)
        if num_remove > 0:
            group_acc = group_acc[num_remove:-num_remove]
            group_CNOT = group_CNOT[num_remove:-num_remove]


        group_CNOT_numses.append(group_CNOT)
        group_acc_reses.append(group_acc)

    return group_CNOT_numses, group_acc_reses

CNOT_numses = [
[2444, 2648, 2986, 3236, 3708, 3794, 4196, 4490, 5038, 5134, 5486, 6000, 6194, 6344, 8226, 10084, 11330, 13078, 2578, 2646, 2948, 3290, 3534, 4026, 4156, 4692, 4824, 5290, 5634, 5876, 6036, 6770, 8278, 9906, 11662, 13168, 2570, 2560, 2970, 3314, 3508, 3904, 4228, 4574, 4914, 5164, 5620, 5980, 6314, 6678, 8208, 10050, 11860, 13138, 2482, 2712, 3004, 3212, 3586, 3826, 4176, 4508, 4920, 5314, 5436, 6076, 6364, 6722, 8144, 9970, 11470, 13270, 2410, 2758, 3018, 3276, 3594, 3924, 4186, 4610, 5002, 5170, 5554, 5946, 6368, 6494, 8168, 9982, 11280, 13196, 2510, 2568, 2848, 3222, 3508, 3904, 4284, 4622, 5042, 5350, 5522, 6010, 6172, 6606, 7954, 10144, 11580, 13136, 2486, 2602, 2912, 3218, 3626, 4032, 4330, 4512, 5060, 5238, 5678, 5898, 6220, 6494, 8110, 10072, 11492, 13024, 2502, 2480, 2850, 3354, 3682, 3948, 4234, 4624, 5052, 5270, 5558, 5798, 6130, 6628, 8214, 9724, 11468, 13200, 2498, 2624, 2856, 3304, 3644, 3970, 4340, 4512, 4770, 5206, 5488, 5836, 6348, 6608, 8158, 9932, 11688, 13370, 2448, 2672, 2958, 3218, 3576, 4108, 4332, 4704, 4816, 5264, 5592, 5858, 6216, 6610, 8196, 9902, 11414, 12994, 2484, 2632, 3008, 3276, 3548, 4012, 4298, 4390, 4912, 5214, 5548, 5922, 6200, 6536, 8410, 9776, 11578, 13222, 2410, 2478, 3048, 3236, 3532, 3830, 4346, 4510, 4836, 5136, 5524, 6002, 6178, 6556, 8296, 10216, 11370, 12904, 2426, 2632, 2910, 3244, 3502, 3840, 4180, 4652, 4760, 5244, 5632, 5866, 6462, 6572, 8212, 9984, 11422, 13334, 2382, 2534, 3060, 3378, 3636, 3948, 4314, 4484, 4968, 5214, 5678, 5922, 6166, 6606, 8192, 9866, 11334, 13160, 2506, 2588, 2932, 3278, 3586, 3948, 4334, 4608, 4962, 5162, 5578, 5812, 6208, 6474, 8148, 10082, 11604, 12992, 2524, 2612, 2886, 3378, 3642, 3788, 4300, 4570, 4894, 5218, 5392, 5952, 6230, 6500, 8176, 9932, 11574, 13228, 2540, 2568, 2912, 3256, 3596, 3928, 4278, 4656, 4954, 5394, 5604, 5944, 6240, 6474, 8204, 10120, 11472, 13282, 2540, 2628, 2930, 3354, 3678, 3868, 4342, 4462, 4966, 5214, 5582, 5792, 6422, 6584, 8230, 10138, 11514, 13090, 2570, 2684, 2864, 3312, 3706, 3962, 4284, 4592, 4972, 5352, 5656, 5912, 6304, 6470, 8376, 9916, 11484, 13056, 2534, 2502, 2934, 3270, 3608, 4154, 4324, 4504, 4942, 5272, 5598, 5960, 6126, 6730, 8190, 9946, 11590, 13016],
[2002, 2000, 2354, 2476, 2784, 3170, 3386, 3592, 3758, 4118, 4172, 4622, 4864, 5100, 6258, 7814, 8870, 10274, 1890, 2078, 2342, 2458, 2892, 3192, 3188, 3504, 3886, 3970, 4336, 4520, 4768, 4970, 6396, 7674, 8550, 10248, 1920, 2036, 2378, 2504, 2776, 3094, 3270, 3456, 3746, 4030, 4254, 4542, 4688, 5022, 6492, 7602, 8792, 10110, 1882, 1910, 2356, 2690, 2832, 3126, 3374, 3580, 3794, 4174, 4374, 4610, 4860, 4994, 6510, 7814, 8932, 10212, 1906, 1964, 2332, 2530, 2832, 3060, 3274, 3488, 3784, 3896, 4258, 4576, 4904, 5028, 6298, 7600, 8850, 10050, 1918, 2116, 2280, 2534, 2840, 3038, 3220, 3468, 3806, 4020, 4136, 4590, 4856, 5084, 6528, 7792, 8756, 10148, 1968, 2028, 2258, 2556, 2818, 3162, 3330, 3574, 3838, 3954, 4246, 4788, 4908, 5052, 6388, 7728, 9156, 9986, 1994, 2044, 2186, 2558, 2738, 3056, 3242, 3502, 3996, 4208, 4616, 4618, 4896, 5108, 6290, 7580, 8990, 10146, 1904, 1966, 2314, 2512, 2922, 3046, 3228, 3616, 3788, 3984, 4298, 4714, 4684, 4894, 6260, 7596, 8834, 10232, 1874, 2016, 2326, 2528, 2702, 3066, 3402, 3558, 3670, 4218, 4210, 4720, 4952, 5052, 6304, 7596, 9022, 10268, 1882, 2026, 2308, 2480, 2778, 2982, 3356, 3486, 3760, 4028, 4398, 4650, 4896, 5108, 6308, 7754, 8866, 10328, 2046, 2034, 2326, 2508, 2684, 3174, 3302, 3468, 3852, 3992, 4354, 4586, 4780, 5192, 6446, 7666, 8742, 9912, 1952, 1958, 2246, 2458, 2882, 3120, 3376, 3484, 3806, 3972, 4300, 4776, 4784, 4998, 6184, 7622, 9082, 10070, 2002, 2116, 2328, 2500, 2808, 2994, 3324, 3502, 3954, 4174, 4194, 4538, 4696, 5156, 6314, 7910, 8916, 10110, 1876, 2080, 2252, 2540, 2798, 3184, 3366, 3578, 3726, 4086, 4314, 4640, 4942, 5146, 6214, 7776, 9008, 10070, 1950, 2092, 2346, 2452, 2936, 3046, 3342, 3476, 3694, 4050, 4354, 4542, 4902, 5062, 6316, 7440, 9014, 10260, 1886, 2020, 2370, 2616, 2718, 2968, 3420, 3610, 3908, 4202, 4240, 4552, 4840, 5000, 6112, 7790, 8802, 10228, 1976, 2070, 2220, 2616, 2846, 3002, 3160, 3570, 3856, 4062, 4226, 4572, 4818, 4978, 6284, 7648, 8970, 10292, 1874, 2044, 2284, 2534, 2764, 2986, 3350, 3510, 3742, 3980, 4340, 4616, 4726, 5118, 6208, 7738, 8860, 10108, 1782, 2036, 2278, 2630, 2792, 2924, 3290, 3572, 3662, 4070, 4462, 4584, 4918, 5204, 6254, 7506, 8848, 10258],
[1888, 2008, 2184, 2584, 2868, 3064, 3176, 3646, 3652, 4172, 4378, 4652, 4910, 5006, 6296, 7618, 8804, 10252, 1922, 2084, 2334, 2584, 2766, 3096, 3152, 3440, 3746, 3932, 4426, 4666, 4858, 5094, 6354, 7640, 8636, 10226, 1996, 1986, 2282, 2438, 2716, 2988, 3236, 3560, 3692, 4064, 4232, 4432, 4786, 5040, 6584, 7716, 8730, 10168, 1870, 1964, 2298, 2596, 2870, 3010, 3248, 3608, 3814, 4110, 4314, 4436, 4898, 5064, 6412, 7880, 8920, 10128, 1938, 2158, 2446, 2446, 2804, 3012, 3268, 3496, 3816, 3996, 4308, 4576, 4798, 5160, 6208, 7622, 8982, 9982, 1944, 2090, 2210, 2628, 2816, 3020, 3370, 3606, 3702, 4002, 4522, 4480, 5060, 5058, 6338, 7626, 9108, 10044, 1922, 2068, 2324, 2588, 2964, 3062, 3236, 3568, 3824, 4122, 4522, 4530, 4790, 5160, 6322, 7832, 8886, 10124, 1848, 2000, 2250, 2654, 2766, 3140, 3274, 3514, 3828, 4076, 4282, 4430, 4842, 5090, 6506, 7618, 8620, 10194, 1928, 2056, 2296, 2558, 2848, 3048, 3248, 3482, 3680, 4094, 4506, 4540, 4844, 5070, 6216, 7712, 8822, 10116, 1938, 1990, 2358, 2606, 2780, 3012, 3390, 3486, 3906, 4094, 4248, 4606, 4878, 5114, 6354, 7602, 9124, 10112, 1908, 2030, 2254, 2510, 2722, 2936, 3242, 3598, 3822, 4044, 4252, 4500, 4800, 5092, 6326, 7520, 8854, 10194, 1850, 2056, 2370, 2592, 2870, 3000, 3326, 3538, 3840, 4170, 4444, 4670, 4946, 5146, 6324, 7554, 8784, 10240, 1944, 1992, 2274, 2468, 2850, 3030, 3258, 3550, 3712, 4256, 4314, 4572, 4934, 4990, 6376, 7708, 8934, 10382, 1880, 2044, 2336, 2690, 2836, 3126, 3270, 3638, 3868, 4010, 4310, 4634, 5132, 5084, 6236, 7584, 8904, 10202, 1804, 2012, 2268, 2586, 2716, 3058, 3390, 3612, 3910, 3974, 4406, 4556, 4598, 5022, 6328, 7632, 8986, 10198, 1940, 1954, 2320, 2494, 2854, 3020, 3334, 3546, 3942, 4128, 4356, 4554, 4890, 5082, 6414, 7650, 8760, 10058, 1942, 2102, 2254, 2492, 2834, 3008, 3416, 3710, 3854, 4002, 4434, 4530, 4864, 5148, 6428, 7816, 8986, 10122, 1926, 2028, 2350, 2490, 2714, 2984, 3218, 3526, 3676, 4126, 4254, 4666, 4706, 5234, 6338, 7742, 9038, 10334, 1862, 1934, 2334, 2576, 2812, 3092, 3324, 3442, 3752, 4136, 4296, 4574, 4798, 5004, 6338, 7696, 8758, 9992, 1854, 2100, 2368, 2602, 2864, 2978, 3340, 3572, 3828, 4122, 4238, 4520, 4822, 5108, 6282, 7764, 8846, 10562]
]

acc_reses = [
[0.9743740030321222, 0.988718926909983, 0.9781545462156351, 0.9729600375375023, 0.983662829876929, 0.9771204911357781, 0.9883424737309081, 0.9912060838738702, 0.9827784476119151, 0.9877127411317348, 0.9828695061712078, 0.9872105739451105, 0.9901027103814526, 0.9813354383949077, 0.9940146823653367, 0.9909135718395371, 0.9917598969680487, 0.9921308818971049, 0.9655157602187173, 0.9700932634605517, 0.9774842883398182, 0.9783334003645993, 0.9816543127830338, 0.984285737502358, 0.987181906082367, 0.9820260514015174, 0.9819554195772944, 0.9830144354801698, 0.984688580466678, 0.9847597178669169, 0.9836751264048449, 0.9907072789458182, 0.9940176010299938, 0.9907692671406492, 0.9960993532372927, 0.995414436018094, 0.9808424116427452, 0.9749326625326714, 0.9787696823381818, 0.9556090392988963, 0.9846410755060547, 0.9872894652231475, 0.9878457785756899, 0.9820432156749755, 0.9883627891665345, 0.9791591312680871, 0.9880518360428879, 0.9890530253236614, 0.9892317724076265, 0.9904562297542395, 0.9900718935424391, 0.9944048524287782, 0.9898957646294403, 0.996874690244031, 0.9844391950407104, 0.9815533115484927, 0.9770876359635591, 0.9884599447439462, 0.9809328332210356, 0.9802870186034716, 0.9731943068431725, 0.986632750442783, 0.9909017686523356, 0.9874950980174334, 0.9878993631962432, 0.9887233549054908, 0.9912907484587897, 0.9873475594202915, 0.9873513592492495, 0.9874087614794469, 0.9956725240472422, 0.9943767800573792, 0.9701199717832502, 0.9599096497191061, 0.9565141531579385, 0.9767691099148093, 0.9744175251481687, 0.9806575913264575, 0.9743143041213703, 0.9790438331776634, 0.9818762286371253, 0.9910416603551363, 0.9890610706599223, 0.9940046670678926, 0.992636390496263, 0.9890232683110786, 0.9863852282455124, 0.9944180916241161, 0.9890561701522247, 0.9944952744034352, 0.9653605374084675, 0.9778414399384843, 0.9644141559125314, 0.9752790033501748, 0.9716732836510997, 0.9837103653317297, 0.987491043622598, 0.9901051061015036, 0.981398583705682, 0.9934682881020875, 0.9913486897660392, 0.9907811995267057, 0.9828524101836761, 0.9927445092409711, 0.9939978761178527, 0.9922457340127216, 0.9912888653398022, 0.9902944564826716, 0.9658958696622056, 0.9742906535722029, 0.9469925438541091, 0.9793960456358386, 0.9858914677776075, 0.9800984339616474, 0.9816529351477123, 0.9793649337326111, 0.9824059726945233, 0.9872222563293004, 0.98178084099425, 0.9871173589878147, 0.9859257962662333, 0.9851632991687843, 0.9840547750611282, 0.9908248782272683, 0.9918377997748865, 0.9941951638389164, 0.9546706977689753, 0.9842403041496024, 0.9716528939544877, 0.9830389040670842, 0.9854119339373649, 0.9799487872196407, 0.9873775845777417, 0.9802333322365409, 0.9912105203261345, 0.9810653362404631, 0.9885581137463857, 0.9884644223695624, 0.9937589170526806, 0.9828419373834065, 0.991133809568406, 0.9858813992523372, 0.9938942790113813, 0.9934183359293198, 0.9795505645271251, 0.9754044732926348, 0.9788053350466375, 0.9839029410963783, 0.9863909038483817, 0.9785628480441839, 0.9829323292325132, 0.983322740045319, 0.9874364011467109, 0.9834756291987735, 0.9912380581890772, 0.9815341239358255, 0.9841849397507588, 0.9847065840190256, 0.9933753031495474, 0.9948672057496256, 0.9913735440516206, 0.9910254525690413, 0.9535526334320317, 0.9592723398816996, 0.972586215372108, 0.9847047365025828, 0.9705643739589214, 0.9778226720777702, 0.9903395253323309, 0.976698230141362, 0.9784144769067281, 0.9869880128989846, 0.9953995347878086, 0.9874704615430674, 0.9847934483438235, 0.9920921330200877, 0.9937356711534748, 0.9938125612317072, 0.9943797644989776, 0.9950598481052135, 0.9771969980913265, 0.9778490072654081, 0.9793141492209412, 0.985508449812356, 0.9705066247042891, 0.9655535534982733, 0.982659935977899, 0.9815191852972522, 0.9857823897692493, 0.982461805356215, 0.9845248218552173, 0.9892429838716554, 0.9928067326704841, 0.9881803564058906, 0.9872564137879556, 0.9926382313271694, 0.9944623118022514, 0.9952682262061466, 0.9649086306270851, 0.9679931621742497, 0.9744001183705314, 0.9753666060851768, 0.9861903474932299, 0.96672304113075, 0.9805558987245606, 0.9833830682505632, 0.988164430117391, 0.9894587444073741, 0.9881117513927673, 0.9712129328798197, 0.9895906455709297, 0.9829082507974899, 0.9849517298379052, 0.9913414139539679, 0.9945349695697858, 0.9957433345747797, 0.9762175982092357, 0.9864912043995492, 0.9536130444967007, 0.9755674779202846, 0.9785449606264385, 0.9889038808042967, 0.9699956245338259, 0.9850823900196191, 0.9826173412506926, 0.987256051201811, 0.9913339647721567, 0.9894169035535911, 0.9850329114282211, 0.9750425327240417, 0.9916387825962124, 0.991426765966738, 0.9936758878129062, 0.9948602957637581, 0.9654165087899655, 0.9683191787843938, 0.9810488821150689, 0.9833563566289091, 0.9887481399663093, 0.9910518015136904, 0.986985809348507, 0.9822117844731257, 0.9887409217775741, 0.9870807700572484, 0.9815988874700785, 0.984709269626346, 0.9821581840961574, 0.9860853777177224, 0.9895311797777432, 0.989942566458441, 0.9970836640465581, 0.9928241994955082, 0.9767902863425719, 0.9574902513807723, 0.9694936648215173, 0.9818466535454916, 0.986893360216812, 0.9708677552513789, 0.9733350958640599, 0.9869177370018388, 0.9792720861179095, 0.9879793165290299, 0.981818863692266, 0.9843953850122097, 0.9853654007355549, 0.9880972530674146, 0.9916933777296857, 0.9942099456032593, 0.9922223091283291, 0.9940896642150595, 0.9655071739460437, 0.9778449746576159, 0.98162957679389, 0.9856689605715121, 0.9818907383269891, 0.9744891593314852, 0.9800889674599227, 0.9870524412135081, 0.9750844111138338, 0.990334572255135, 0.9822609453830868, 0.9879652262331339, 0.9911456109344976, 0.9902873882506014, 0.9924336732293266, 0.9915704259585612, 0.9970233450046525, 0.9929555667333606, 0.9610459252832672, 0.972369781969661, 0.9627276799011072, 0.9668865215459798, 0.9838895441121617, 0.9851962862097392, 0.9855433210401328, 0.9828285594791241, 0.977787560252839, 0.9886038306791392, 0.9959143996479441, 0.9894055136368393, 0.9840114972947849, 0.9931500554173173, 0.9901167328649311, 0.9916890876820202, 0.9913339053922299, 0.9919590950099019, 0.9823287135334821, 0.979210300427546, 0.9804506274709495, 0.97339296372364, 0.9795149618019582, 0.9850170080802477, 0.9835463821546848, 0.9862031401340281, 0.9846452616857145, 0.9841175101756431, 0.9873377156623707, 0.9854578380445476, 0.9876446728070837, 0.9922577782956641, 0.993011000500033, 0.9941362150629366, 0.994149387232194, 0.9953204411432497, 0.9730164522450052, 0.9712678979354663, 0.9726710088527086, 0.9851813316428125, 0.97177792360702, 0.9873405099420693, 0.9893047274830915, 0.9862135085236029, 0.9888950677846359, 0.9818500281708031, 0.9856391053332797, 0.9883420549730091, 0.99324184780105, 0.9929966330944523, 0.9904950261587248, 0.9928690219061472, 0.9959428907240824, 0.9977343678604105, 0.9635312011301033, 0.9631363798833823, 0.9873365832563161, 0.9479929628445543, 0.9758500491789156, 0.9861822724350696, 0.9804756054704552, 0.977746488250251, 0.9886157513071471, 0.9875406122968071, 0.991482079998108, 0.9877554231066107, 0.9833268157691183, 0.9909510072952175, 0.9945732953584662, 0.9944738765467176, 0.9957268280744442, 0.9925128827482572],
[0.9598758999680704, 0.9462196086227971, 0.9485836686909805, 0.9850424014565196, 0.956530150721542, 0.9754921452659446, 0.9730549592775379, 0.981144906267059, 0.9839178398498429, 0.9913120272258664, 0.9796255598666159, 0.9902310417550847, 0.9903226583353929, 0.9762201658076701, 0.9917498256106608, 0.9925066275783858, 0.9942367082764755, 0.9972844720552506, 0.9752386421805529, 0.9755993214149219, 0.9749407394053533, 0.9804002400035484, 0.9745056517979989, 0.9773800563201588, 0.9801209200081216, 0.9857311267678348, 0.9807430565564084, 0.9882203361802079, 0.9910669357322388, 0.9869072437309317, 0.9899339711284413, 0.9863990176701973, 0.9941013480538632, 0.9888621016131695, 0.9912883680558117, 0.9935957791873665, 0.9703298817651232, 0.968860225084169, 0.9578339371213795, 0.976908482162533, 0.9657661216836324, 0.9844259243933363, 0.9774632191800564, 0.969811781971226, 0.9759364905857829, 0.9912091578609522, 0.9890215594503188, 0.9937103996382934, 0.9886053800739532, 0.9840235778653077, 0.9930075428935359, 0.994559943814396, 0.9907441165173281, 0.9928334976104822, 0.9699670888301952, 0.965079390845429, 0.9657538597428392, 0.9808060717425514, 0.9752821373440441, 0.9823623559291966, 0.9856083003817839, 0.9835065604879524, 0.9820086995182467, 0.9865663190113327, 0.9761003279731056, 0.9856732216822931, 0.9897093492110864, 0.9825632758574767, 0.9828047214748736, 0.9923186306806275, 0.9941194066559713, 0.9949058893611942, 0.9712073430724687, 0.9651896225377865, 0.9810786645104295, 0.9725034274987212, 0.9868345469189932, 0.977817835210551, 0.9777213367461594, 0.9734909222955497, 0.9872354281654653, 0.9920868281616251, 0.9887171424657947, 0.9878016741559503, 0.9842523433704262, 0.987436950476905, 0.9904699922247171, 0.992667377059582, 0.9939237267177853, 0.9951215401192953, 0.9680172944789492, 0.9727631827521028, 0.9642081259934862, 0.9266606361414241, 0.981941246518632, 0.976081468759531, 0.9805000211052339, 0.9755972553372237, 0.9858720312199871, 0.9864912643833156, 0.9806903612260726, 0.9894441963630916, 0.9900685555102569, 0.9895521413697895, 0.9956529737383193, 0.9932965657850221, 0.9945874214242187, 0.9786162221064665, 0.9457499041801922, 0.980803403964555, 0.9786018725489755, 0.9829970224221551, 0.9863420159558555, 0.9691713462553744, 0.9819891299328627, 0.991190378947949, 0.9829279887569506, 0.9877676977246945, 0.9876434808719351, 0.9866591109066195, 0.9889873875957389, 0.9922676132498528, 0.9860552045099339, 0.9944438374593092, 0.9907383325312104, 0.9950059654929045, 0.9700205331547777, 0.9709418189723945, 0.9854856378111688, 0.989350142212858, 0.9831888677499981, 0.9719252595587123, 0.9847277414633372, 0.9910629409536004, 0.98775142707541, 0.9915844822771208, 0.9811294048567161, 0.9910422587483894, 0.9874326267124799, 0.9917086968160933, 0.9862687413520622, 0.9816711646014273, 0.9944458652275526, 0.9974912405019413, 0.9759413791654112, 0.9617009234792729, 0.9733777289445577, 0.9746176102007512, 0.9663827531415413, 0.9845260452649751, 0.9811901626280551, 0.9840645692933513, 0.9869998706419709, 0.9934910548805954, 0.9906553639533471, 0.9713293049933537, 0.9932358291964178, 0.9877346333807828, 0.9883729224595588, 0.9828284886320758, 0.9956581596765113, 0.9948515892398724, 0.9374913277951069, 0.939793438114456, 0.9853692573056544, 0.9591000980806365, 0.9907744013404066, 0.9797019277071043, 0.980965749853138, 0.9818760759659894, 0.9696135292580851, 0.985693778667459, 0.9827922010139782, 0.9761341824358826, 0.9854565503511018, 0.993275405496656, 0.9881541136439409, 0.989719930600702, 0.9858941445583793, 0.9931873685646364, 0.980330182331673, 0.9753025077410872, 0.9488792463322161, 0.9801080386328594, 0.9772222539726741, 0.9768191723814933, 0.9807124726464466, 0.9865278770964503, 0.984837294832401, 0.9893751765632222, 0.9909601807796831, 0.9873113677393034, 0.9830194154496354, 0.9860802908238817, 0.9937129622065889, 0.9883720433532988, 0.9911092011380926, 0.9960210324086407, 0.981950879934426, 0.9557229486467337, 0.988569262746888, 0.9620977538783392, 0.9843167746561213, 0.98430637138718, 0.9781086308536421, 0.9898645880142612, 0.9905954646931202, 0.9904358453169444, 0.9840405118852383, 0.9633992099878236, 0.9889361899121112, 0.9779487412911132, 0.9866891107464338, 0.9968249201917634, 0.9969340565624127, 0.9898892714393647, 0.9664051350948765, 0.9650465168496052, 0.9732627421167329, 0.9762883320634411, 0.9763229546747315, 0.9900970486317512, 0.9844672111687167, 0.983912388380587, 0.9693383437712286, 0.9870323142512646, 0.9853590734564845, 0.9740104131755908, 0.9907314827808661, 0.9861168302735919, 0.9934575600636598, 0.991522857136247, 0.9836666137719482, 0.9972152711018794, 0.9676972037170379, 0.9467523292049891, 0.9744660289201493, 0.9795942407261644, 0.9864981887590636, 0.9877650149303336, 0.9873672246650046, 0.9884435084884783, 0.9686859501867374, 0.98268253143896, 0.9837295168598605, 0.9775535364485398, 0.9904579113291088, 0.9905657400432506, 0.9875588578270457, 0.9934365155147888, 0.9952176229451529, 0.9972782135267745, 0.9772440195650046, 0.9711789376147087, 0.9721359275544016, 0.983127178959782, 0.9760847101776473, 0.957880428227392, 0.9874036952423187, 0.9868914610276794, 0.9764241032375993, 0.9881232391937423, 0.9866234080533391, 0.9753006116194681, 0.9867735983629424, 0.9851057699507102, 0.9902865428747931, 0.9783035650258367, 0.9962260129196812, 0.9877968504970307, 0.9355786583478337, 0.952859461924714, 0.9727179867812261, 0.9793993756450732, 0.9864759461046155, 0.985764723397349, 0.9768458638339135, 0.9801909147445502, 0.9921517423757173, 0.9896978155644219, 0.9906892831660981, 0.9904900797718744, 0.9930934907173133, 0.9938941003436039, 0.9911084771452127, 0.993290185968435, 0.9953544140296812, 0.9936884670706754, 0.9769085368107175, 0.9577809229089159, 0.9833076102022946, 0.9824856546636361, 0.958109027043008, 0.9592796636101889, 0.9840061730251007, 0.9830805188419536, 0.9812887932154227, 0.9693297076024688, 0.9870062598982996, 0.981954942312271, 0.9849791024380697, 0.9826579729285738, 0.9944562912669831, 0.9765569529292184, 0.9953749181268322, 0.9945622086559622, 0.9486658922115403, 0.9650631321771252, 0.9786730560824889, 0.9818672714458642, 0.9760147211141634, 0.9825125361957213, 0.9842220078368843, 0.9882414374550147, 0.9900335075443306, 0.9871208264699678, 0.9764064558411586, 0.9893758332278948, 0.9869882638424576, 0.9813888960674519, 0.9809095267621809, 0.9941828875378659, 0.9938520815978241, 0.9953957822564505, 0.9785105629092052, 0.9736645515637691, 0.9809038640425739, 0.9760955151840993, 0.9780163957814227, 0.9657620365226097, 0.9631028771714659, 0.9897029406991107, 0.9910619258922785, 0.9787994139399974, 0.9906308077716728, 0.9861536762198975, 0.988053918227897, 0.9886463284516153, 0.9931117299453348, 0.9813880971862285, 0.9924031503330089, 0.9954296352927214, 0.9741075964034661, 0.9558319076732492, 0.9530656217923404, 0.9857620018262986, 0.970050445234762, 0.9640522129337862, 0.9794263863609254, 0.9775134764778145, 0.9768120169704333, 0.9886978994810028, 0.9869363917260562, 0.9867711069478526, 0.9899016084739725, 0.9831411437946088, 0.990750854359234, 0.9920076745858335, 0.993552686982742, 0.9910109083936324],
[0.9590181560278087, 0.9788630140231445, 0.982928693456044, 0.9868004947842887, 0.9836921177332895, 0.9857612905918907, 0.9900032287749738, 0.9779753140026639, 0.9921857121524653, 0.9797566962889406, 0.9854695404795777, 0.9940499669410819, 0.9889801248705494, 0.9885862081096022, 0.9932832719170726, 0.9858835481939907, 0.9961596131525746, 0.9890489027845955, 0.970684718759558, 0.9560337915380989, 0.9705269218124017, 0.9876297428800077, 0.979638769200412, 0.9586052312562313, 0.980940523506175, 0.9860259372493274, 0.9773884932069242, 0.9764520690547817, 0.9855984895238468, 0.982155621755018, 0.9854669641728822, 0.9929039482738709, 0.9946857705470386, 0.9917416588961063, 0.9961368442326183, 0.9963068963617087, 0.9722331564318225, 0.9783251890831157, 0.9642773225600251, 0.9764983775529504, 0.979950134461868, 0.9880071308950408, 0.9789974093700473, 0.9772791958007618, 0.986184698047224, 0.9786487729253855, 0.9834010014236239, 0.9836990380870219, 0.9940958637166295, 0.9892477605182854, 0.9927031418001642, 0.9928774859635863, 0.9963949920157092, 0.997675597899944, 0.9666507744121823, 0.9747548151432569, 0.9762875013159955, 0.9846126622228988, 0.9776450531954679, 0.9870839166103256, 0.9897769767456555, 0.9879281636130568, 0.9802041668207941, 0.987254322528424, 0.9918691692862804, 0.9774863837518167, 0.9881227430470187, 0.9875753522188242, 0.9904531923003965, 0.9945441484471672, 0.9945687658715182, 0.9917585271334874, 0.9696971988371718, 0.9650114456718056, 0.9809510727408502, 0.9737986233701977, 0.9818946124719815, 0.9829531921687304, 0.9781142163285571, 0.992295684728168, 0.9877255898120115, 0.9790784254931325, 0.9873781694302425, 0.9911525850617852, 0.9816703705328162, 0.9855159083307491, 0.9861509300531545, 0.994059803945885, 0.9953370699341205, 0.9901834131932687, 0.9636115288606779, 0.9776967338971927, 0.9663535452158202, 0.9569858133139327, 0.9855765335988572, 0.9800429030984722, 0.9885148409044338, 0.9840624533639395, 0.9864735784350066, 0.9937469959272661, 0.979747632838, 0.9905761481279852, 0.9879518151290442, 0.9906340938104156, 0.9868162296344717, 0.9929484138754859, 0.9950954918155721, 0.9946561472346012, 0.9595053981290469, 0.9549501829566819, 0.9851938517287797, 0.9857584580320503, 0.9844619036879911, 0.9765312836604988, 0.9796297183299237, 0.983885572311546, 0.989119000904482, 0.9793282158705746, 0.9837008757739579, 0.9884069562009543, 0.992526130592219, 0.9927915989355838, 0.9889501335829267, 0.9905932626553416, 0.991417116298494, 0.9949086348015671, 0.9647691969829412, 0.9686769855884235, 0.9814579341204728, 0.9868922956726167, 0.9817371418650535, 0.9819313338557241, 0.9694984390548227, 0.9883943819331967, 0.9892892263228585, 0.9842609244256506, 0.9815170541707952, 0.9901728103660239, 0.990318718587551, 0.9874891996776732, 0.9902879605278656, 0.9917589481074149, 0.9932549629549566, 0.994444787551243, 0.9578959121533572, 0.969441818889282, 0.9811268007358969, 0.9822440157478027, 0.9771596364110791, 0.9740514743414967, 0.9897538423758787, 0.989808917683096, 0.9825754319730984, 0.9639125907324732, 0.9825836532717542, 0.9851605408874001, 0.9817177768695883, 0.9916334318234077, 0.9876101082668518, 0.9961160421474143, 0.9952753186341766, 0.993832231039588, 0.9749555649344186, 0.9816974528632652, 0.9837127421454422, 0.9794496636805831, 0.9505653447875274, 0.9846069656055266, 0.9822278122442107, 0.9790002236372507, 0.990442097443439, 0.9881047785947461, 0.9883603159451906, 0.9803575278376637, 0.9865506518616042, 0.9820230736777997, 0.9930036068330476, 0.9907972844688411, 0.9855570255408592, 0.9951126605454682, 0.9691976997094832, 0.9745355860294991, 0.9660231692436647, 0.9719696845731177, 0.9742902700160762, 0.9885154567318672, 0.9776627201447365, 0.9878947765881152, 0.9796407819397845, 0.9797882534177578, 0.9933086049510458, 0.9912014008161402, 0.9902983401920937, 0.9849657509792822, 0.9893937160534718, 0.9945009352584866, 0.9966787100130327, 0.9922276735940604, 0.9678894944091458, 0.967344230521527, 0.9843434217040425, 0.9752655764361499, 0.9816418911300874, 0.9852507164043762, 0.973931218703137, 0.9910514953806708, 0.9908454420046119, 0.9726918414683834, 0.9930578476268995, 0.9774976038417816, 0.9827268131927186, 0.9882007958744027, 0.9956813455362008, 0.990111176743824, 0.99124801336039, 0.9938346799893797, 0.9742317743045491, 0.9680975907211193, 0.971808874099782, 0.986023320652768, 0.9822320943044399, 0.9908846026923963, 0.9851793163517425, 0.981689632161048, 0.9845656781084584, 0.9748208119911376, 0.9851810406791855, 0.9827311932994685, 0.9897003371876741, 0.9864361896063872, 0.993823111057283, 0.9936385160096745, 0.9935197830780433, 0.9934438467579261, 0.9581211703119961, 0.9807062754448229, 0.9570236136058128, 0.9707747624158872, 0.9849422226378235, 0.9680233713699055, 0.98250866974607, 0.9761641028064221, 0.990385294141842, 0.9828680429502241, 0.9842331872698348, 0.9892972818439529, 0.9875024665550931, 0.990508735480033, 0.9794650908116453, 0.9874041913574848, 0.9943310618513876, 0.9905321625299653, 0.9417058816536753, 0.96685020610665, 0.9920312175579432, 0.9747799126504559, 0.9835254953821824, 0.9845305089242908, 0.9805834907454818, 0.9877538787048618, 0.9889755864880005, 0.977165974894535, 0.9850328580565402, 0.9809514880443746, 0.9842782809293449, 0.9924125701523014, 0.9861415353936402, 0.9843959810109513, 0.9884191191041289, 0.9970383049902903, 0.9785993629955726, 0.9776790073550814, 0.9795770835687792, 0.9884709725104112, 0.9703306007508858, 0.978052381096678, 0.9839641981095961, 0.9902595883864812, 0.9784725346528158, 0.9881306516644985, 0.9809664125161146, 0.9858111855276394, 0.9971191884282771, 0.9911605148073395, 0.9877527391030602, 0.9957375527086086, 0.9909020182911095, 0.9939046515425045, 0.9811284185472839, 0.9370356221263081, 0.9534248157430893, 0.9798211604257969, 0.9460045263824719, 0.9585741893266642, 0.9839796628397014, 0.9803437253216939, 0.9912016554954789, 0.9737415835335449, 0.9877943599221618, 0.9871512364322841, 0.9823126990469355, 0.9856648070453646, 0.988932196229732, 0.9926899687366196, 0.9915916349144557, 0.9925906110408484, 0.9791379243178786, 0.9808457440113977, 0.9800107215858955, 0.9834670792588307, 0.9754162494506964, 0.9828921574945946, 0.9812266329659294, 0.9834329495360747, 0.9857140795694368, 0.9913002867548767, 0.9896580062806954, 0.9878273011315934, 0.9895007026825823, 0.991533475205153, 0.9914379150330865, 0.9930987370685453, 0.9955201745176844, 0.9946428544615638, 0.9682084548920853, 0.9490936999757974, 0.9764275514671152, 0.983170515828703, 0.9794948002949746, 0.9902080956973737, 0.9844471393241107, 0.9843053260003665, 0.9894540921235678, 0.9885361195060426, 0.9886608728810431, 0.9901643130318062, 0.9864352946315096, 0.9914889932000519, 0.9918516301156641, 0.9950219993900549, 0.9899998960267017, 0.9948889613445631, 0.9402375679962645, 0.9714325066403454, 0.9745835138820498, 0.9863821867792968, 0.980321303614668, 0.9887864041700091, 0.9899876249236379, 0.9894815087776201, 0.9863442446086935, 0.9790158117205648, 0.9917698511563504, 0.9760501609819361, 0.9896857748643881, 0.986469810119403, 0.9958781600301266, 0.9949240112096549, 0.9915797116233281, 0.9955545082084821]
]


acc_reses_new = []
CNOT_numses_new = []
for i, acc_rese in enumerate(acc_reses):
    acc_rese_new = []
    CNOT_nums_new = []
    for j, acc in enumerate(acc_rese):
        if j % 18 > 12 or j % 18 == 3 or j %18 == 8:
            acc_rese_new.append(acc)
            CNOT_nums_new.append(CNOT_numses[i][j])
    acc_reses_new.append(acc_rese_new)
    CNOT_numses_new.append(CNOT_nums_new)


# clustering
acc_clusters_1 = [acc_reses_new[0][i::7] for i in range(7)]
CNOT_clusters_1 = [sum(CNOT_numses_new[0][i::7])/len(CNOT_numses_new[0][i::7]) for i in range(7)]
acc_clusters_2 = [acc_reses_new[1][i::7] for i in range(7)]
CNOT_clusters_2 = [sum(CNOT_numses_new[1][i::7])/len(CNOT_numses_new[1][i::7]) for i in range(7)]
acc_clusters_3 = [acc_reses_new[2][i::7] for i in range(7)]
CNOT_clusters_3 = [sum(CNOT_numses_new[2][i::7])/len(CNOT_numses_new[2][i::7]) for i in range(7)]



Gate_list = [sum(item) for item in CNOT_numses_new]
# print(Gate_list)

average_reduction_percentage_01 = (Gate_list[0]-Gate_list[1])/Gate_list[0]
average_reduction_percentage_02 = (Gate_list[0]-Gate_list[2])/Gate_list[0]

# print("gate average reduction:", average_reduction_percentage_01, average_reduction_percentage_02)

# i indicates the acc level
i=0
# Create a box plot for each acc level, base on the upper row
plt.boxplot(acc_clusters_1[i], positions=[3], vert=False, boxprops={'color': 'blue'})
plt.boxplot(acc_clusters_2[i], positions=[2], vert=False, boxprops={'color': 'green'})
plt.boxplot(acc_clusters_3[i], positions=[1], vert=False, boxprops={'color': 'yellow'})

# Set labels and a title for the plot
plt.xlabel("Cluster Data Points")
plt.ylabel("Average of Clusters in l2")
plt.title("Box Plots for Each Cluster with Average of Clusters in l2")
plt.show()
# plt.savefig('Pauli_Na+' + '\\photo' + '1s++' + '.png')